<!--
The helpers script introduces a JavaScript object named "helpers", which contains three functions.

helpers.fetchNewMessages(callback)
This goes to the server to fetch new messages your client hasn't displayed yet. When it has retrieved them, it passes them to the callback you provided.

helpers.renderMessage(messageText)
This takes the text of a message, transforms it into html, and renders that html to the screen.
Note: the function searches the page for a node with the class "messages", and puts results in there. If there isn't one already, it will be created for you.

helpers.sendMessage(messageText)
This takes a string and sends it to the chat server

Note: you don't need to handle user input, you can just send messages via the console.
If you don't have rendering working yet, You check if your call worked by looking in the example client
Last, you'll want to set up polling of the helpers.fetchNewMessages() function, using setInterval().
-->

<html>
<head>
<title>Code Class Chat</title>
</head>
<body>

<h1>Code Class Chat</h1>

<form id="form" style="width:70%;margin:0 auto;">
	<label>Type your message here:</label>
		<input id="message" type="text" style="width:100%">
</form>

<div style="width:70%;margin:0 auto;height:300px;overflow-y:scroll;">
	<ul class="messages chatroom"></ul>
</div>

<script src="jquery-1.9.1.min.js"></script>
<!-- <script src="http://codeclasschat.herokuapp.com/helpers.js"></script> -->
</body>

<script>

function render(messageText){
	helpers.renderMessage(messageText);	
}

function fetch() {
	console.log("fetch() was called");
	// helpers.fetchNewMessages(render)
	$.ajax( "http://codeclasschat.herokuapp.com/messages.jsonp?callback=?", {
		type: 'GET',
		crossDomain: true,
		datatype: "jsonp",
		success: function(success){

			console.log(success);

			// helpers.renderMessage(success);
		},
		error: function() {
			
			console.log("fetch() error");
		}
	});
}

setInterval(fetch,15000);

// When the form gets submitted...
$('#form').submit( function() {

	// Get the input from the form
	var message = $('#message').val();

	// 'GET' server call
	$.ajax("http://codeclasschat.herokuapp.com/messages/create", {
		crossDomain: true,
		dataType: "jsonp",
	    success: function (success){
	    	console.log(success);
		   	$('input').val(''); 	
	    }
	});

	// Don't refresh
	return false;
});

</script>
</html>